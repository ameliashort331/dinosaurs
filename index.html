<html>
  <head>
    <script src="https://kit.fontawesome.com/aede5f8533.js" crossorigin="anonymous"></script>
    <meta charset="utf-8">
    <link href="d3-geomap/d3-geomap.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="jquery-csv.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Julius+Sans+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Monda&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  </head>
  <body>
    <p style = "font-size:2em;font-family:Julius Sans One">Jurassic period</p>
    <!-- The Modal -->
    <div id="myModal" class="modal">

      <!-- Modal content -->
      <div style = "width:900px;margin:auto;">
        <div id = "continentToggle"></div>
      <div class="modal-content" style = "background-color:#C6BDC1;width:900px;height:600px;position:relative;">
        <span class="close">&times;</span>
        <div id = "modalHeader">
          <p id = "modaltext"></p>
        </div>


        <div class="container">
          <div class="type">
            <span id = "all" class="col-lg-auto button" onclick = "getCountryName('all')">
              All
            </span>
            <span id = "carnivores" class="col-lg-auto button" onclick = "getCountryName('carnivore')">
              Carnivores
            </span>
            <span id = "herbivores" class="col-lg-auto button" onclick = "getCountryName('herbivore')">
              Herbivores
            </span>
            <span id = "omnivores" class="col-lg-auto button" onclick = "getCountryName('omnivore')">
              Omnivores
            </span>
            <span id = "other" class="col-lg-auto button" onclick = "getCountryName('other')">
              Other
            </span>
          </div>
        </div>

        <div class = "line"></div>
        <div id = "results"></div>
      </div>
      </div>
    </div>

    <div onclick="getCountryName('all')" class="d3-geomap" id="map"></div>

    <div onclick="color()">hiiii</div>

  </body>
  <script src="https://unpkg.com/d3@5.16.0/dist/d3.min.js"></script>
  <script src="https://unpkg.com/topojson@3/dist/topojson.min.js"></script>
  <script src="d3-geomap/d3-geomap.min.js"></script>
  <script>
    var map = d3.geomap()
    .geofile('https://raw.githubusercontent.com/ameliashort331/dinosaurs/main/topojson/world/countries.json')
    .draw(d3.select('#map'));
</script>


    <script>
    function color() {

      console.log("uhh");

        $.getJSON("https://raw.githubusercontent.com/ameliashort331/dinosaurs/main/Jurassic.json", function(json) {
            for (var i = 0; i < json.length; i++){
              var obj = json[i];
              countries.push(obj["Country"]);
            }
          });

        $.getJSON("https://raw.githubusercontent.com/ameliashort331/dinosaurs/main/codes.json", function(json) {
            for (var i = 0; i < json.length; i++){
              var obj = json[i];
              for (var j = 0; j < countries.length; j++){
                if (obj.Country === countries[j]) {
                  // console.log(obj["Alpha-3 code"]);
                  codes.push(obj["Alpha-3 code"]);
                }
              }
            }
            for (var i = 0; i < codes.length; i++){
              var cols = document.getElementsByClassName("unit-" + codes[i]);
              console.log(cols);
              console.log(cols.length);
              for(var j = 0; j < cols.length; j++) {
                console.log(cols[j]);
                  cols[j].style.fill = "#abdede";
              }

             // document.getElementsByClassName("unit-" + codes[j]).style.fill = "blue";
            }
          });



      }
    </script>

    <script>
      var modal = document.getElementById("myModal");
      var span = document.getElementsByClassName("close")[0];
      var countryName;
      var continentName;
      var country = true;
      const countries = [];
      const codes = [];







      function getCountryName(type) {

        var x = document.getElementsByClassName("active");
          countryName = x[0].innerHTML.replace('<title>', '');
          countryName = countryName.replace('</title>', '');
          modal.style.display = "block";
          document.getElementById("modaltext").innerHTML = countryName;
          getDinosaurs(type);
          getContinent(countryName);
      }

      function getContinent(countryName) {
        $.getJSON("https://raw.githubusercontent.com/ameliashort331/dinosaurs/main/Jurassic.json", function(json) {
        for (var i = 0; i < json.length; i++){
          var obj = json[i];
          if (obj.Country == countryName) {
            continentName = obj.Continent;
            document.getElementById("continentToggle").innerHTML = "Switch to all dinosaurs from " + obj.Continent + " <i style = \"margin-left:2%\" class=\"fas fa-sync\" onclick = \"switchToContinent('" + obj.Continent + "')\"></i>";
          }
        }

        });
      }

      function switchToContinent(continent) {
        document.getElementById("modaltext").innerHTML = continentName;
        country = false;
        document.getElementById("continentToggle").innerHTML = "Switch to all dinosaurs from " + countryName + " <i style = \"margin-left:2%\" class=\"fas fa-sync\" onclick = \"switchToCountry('" + countryName + "')\"></i>";
        document.getElementById("results").innerHTML = '';

        $.getJSON("https://raw.githubusercontent.com/ameliashort331/dinosaurs/main/Jurassic.json", function(json) {
            for (var i = 0; i < json.length; i++){
              var obj = json[i];
              if (obj.Continent == continentName) {
                var z = document.createElement('p'); // is a node
                z.innerHTML = obj.Name + "-" + obj.Diet;
                document.getElementById("results").appendChild(z);
              }
            }
          });
      }

      function switchToCountry(countryName) {
        document.getElementById("modaltext").innerHTML = countryName;
        country = false;
        document.getElementById("continentToggle").innerHTML = "Switch to all dinosaurs from " + continentName + " <i style = \"margin-left:2%\" class=\"fas fa-sync\" onclick = \"switchToContinent('" + continentName + "')\"></i>";
        document.getElementById("results").innerHTML = '';

        $.getJSON("https://raw.githubusercontent.com/ameliashort331/dinosaurs/main/Jurassic.json", function(json) {
            for (var i = 0; i < json.length; i++){
              var obj = json[i];
              if (obj.Country == countryName) {
                var z = document.createElement('p'); // is a node
                z.innerHTML = obj.Name + "-" + obj.Diet;
                document.getElementById("results").appendChild(z);
              }
            }
          });
      }

        function getDinosaurs(type) {
          document.getElementById("results").innerHTML = '';
          console.log(type);
          $.getJSON("https://raw.githubusercontent.com/ameliashort331/dinosaurs/main/Jurassic.json", function(json) {

            if (country) {
              if (type == 'all') {
                for (var i = 0; i < json.length; i++){
                  var obj = json[i];
                  if (obj.Country == countryName) {
                    var z = document.createElement('p'); // is a node
                    z.innerHTML = obj.Name + "-" + obj.Diet;
                    document.getElementById("results").appendChild(z);
                  }
                }
              } else {
                  for (var i = 0; i < json.length; i++){
                    var obj = json[i];
                    if (obj.Diet == type) {
                      var obj = json[i];
                      if (obj.Country == countryName) {
                        var z = document.createElement('p'); // is a node
                        z.innerHTML = obj.Name + "-" + obj.Diet;
                        document.getElementById("results").appendChild(z);
                      }
                    }
                  }
              }
            } else {
              if (type == 'all') {
                for (var i = 0; i < json.length; i++){
                  var obj = json[i];
                  if (obj.Continent == continentName) {
                    var z = document.createElement('p'); // is a node
                    z.innerHTML = obj.Name + "-" + obj.Diet;
                    document.getElementById("results").appendChild(z);
                  }
                }
              } else {
                  for (var i = 0; i < json.length; i++){
                    var obj = json[i];
                    if (obj.Diet == type) {
                      var obj = json[i];
                      if (obj.Continent == continentName) {
                        var z = document.createElement('p'); // is a node
                        z.innerHTML = obj.Name + "-" + obj.Diet;
                        document.getElementById("results").appendChild(z);
                      }
                    }
                  }
              }
            }



          });
        }

        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
          modal.style.display = "none";
          country = true;
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
          if (event.target == modal) {
            modal.style.display = "none";
            country = true;
          }
        }
    </script>
</html>
