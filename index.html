<html>
  <head>
    <script src="https://kit.fontawesome.com/aede5f8533.js" crossorigin="anonymous"></script>
    <meta charset="utf-8">
    <link href="d3-geomap/d3-geomap.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="jquery-csv.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Julius+Sans+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Monda&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  </head>
  <body>
    <!-- The Modal -->
    <div id="myModal" class="modal">

      <!-- Modal content -->
      <div style = "width:900px;margin:auto;">
        <div id = "continentToggle"><i style = "margin-left:2%" class="fas fa-sync"></i></div>
      <div class="modal-content" style = "background-color:#C6BDC1;width:900px;height:600px;position:relative;">
        <span class="close">&times;</span>
        <div id = "modalHeader">
          <p id = "modaltext"></p>
        </div>


        <div class="container">
          <div class="type">
            <span id = "all" class="col-lg-auto button" onclick = "getCountryName('all')">
              All
            </span>
            <span id = "carnivores" class="col-lg-auto button" onclick = "getCountryName('carnivore')">
              Carnivores
            </span>
            <span id = "herbivores" class="col-lg-auto button" onclick = "getCountryName('herbivore')">
              Herbivores
            </span>
            <span id = "omnivores" class="col-lg-auto button" onclick = "getCountryName('omnivore')">
              Omnivores
            </span>
            <span id = "other" class="col-lg-auto button" onclick = "getCountryName('other')">
              Other
            </span>
          </div>
        </div>

        <div class = "line"></div>
        <div id = "results"></div>
      </div>
      </div>
    </div>

    <div onclick="getCountryName('all')" class="d3-geomap" id="map"></div>
  </body>
  <script src="https://unpkg.com/d3@5.16.0/dist/d3.min.js"></script>
  <script src="https://unpkg.com/topojson@3/dist/topojson.min.js"></script>
  <script src="d3-geomap/d3-geomap.min.js"></script>
  <script>var map = d3.geomap()
    .geofile('https://raw.githubusercontent.com/ameliashort331/dinosaurs/main/topojson/world/countries.json')
    .draw(d3.select('#map'));</script>

    <script>
      var modal = document.getElementById("myModal");
      var span = document.getElementsByClassName("close")[0];

      function getCountryName(type) {
        var x = document.getElementsByClassName("active");
        countryName = x[0].innerHTML.replace('<title>', '');
          countryName = countryName.replace('</title>', '');
          modal.style.display = "block";
          document.getElementById("modaltext").innerHTML = countryName;
          getDinosaurs(type);
          getContinent(countryName);
      }

      function getContinent(countryName) {
      console.log(countryName);
        document.getElementById("continentToggle").innerHTML = '';
        $.getJSON("https://raw.githubusercontent.com/dbouquin/IS_608/master/NanosatDB_munging/Countries-Continents.csv", function(json) {
          console.log("hewwo");
        for (var i = 0; i < json.length; i++){
          var obj = json[i];
          if (obj.Country == countryName) {
            document.getElementById("continentToggle").innerHTML = obj.Continent;
          }
        }

        });
      }


        function getDinosaurs(type) {
          document.getElementById("results").innerHTML = '';
          console.log(type);
          $.getJSON("https://raw.githubusercontent.com/ameliashort331/dinosaurs/main/Dinosaurs.json", function(json) {

            if (type == 'all') {
              for (var i = 0; i < json.length; i++){
                var obj = json[i];
                if (obj.Country == countryName) {
                  var z = document.createElement('p'); // is a node
                  z.innerHTML = obj.Name;
                  document.getElementById("results").appendChild(z);
                }
              }
            } else {
                for (var i = 0; i < json.length; i++){
                  var obj = json[i];
                  if (obj.Diet == type) {
                    var obj = json[i];
                    if (obj.Country == countryName) {
                      var z = document.createElement('p'); // is a node
                      z.innerHTML = obj.Name;
                      document.getElementById("results").appendChild(z);
                    }
                  }
                }
            }

          });
        }

        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
          modal.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
          if (event.target == modal) {
            modal.style.display = "none";
          }
        }
    </script>
</html>
